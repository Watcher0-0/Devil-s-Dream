from utils.logger import log_event

def exploit_buffer_overflow(device, payload):
    if device.vulnerable and len(payload) > 500:
        device.compromised = True
        log_event(f"Exploit succeeded on {device.ip}")
        return "CRASH! Shell access granted."
    elif not device.vulnerable:
        log_event(f"Exploit failed: {device.ip} not vulnerable")
        return "Exploit failed: Target not vulnerable"
    else:
        log_event(f"Exploit failed: Payload too small")
        return "Exploit failed: Buffer overflow unsuccessful"
