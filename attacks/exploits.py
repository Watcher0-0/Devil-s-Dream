from utils.logger import log_event

def exploit_buffer_overflow(device, payload):
    if device.vulnerable and len(payload) > 500:
        device.compromised = True
        log_event(f"Exploit succeeded on {device.ip}")
        return "Shell access granted"
    return "Exploit failed"